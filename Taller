import numpy as np
import matplotlib.pyplot as plt

d = 0.5                  
D = 5                    
wavelength = 0.0005      
num_particulas = 10000   
num_posiciones = 100      

intensidad_particulas = np.zeros(num_posiciones)
intensidad_cuantica = np.zeros(num_posiciones)
intensidad_ondas = np.zeros(num_posiciones)

x = np.linspace(-1, 1, num_posiciones)

### 1. Simulación del Experimento Doble Rendija con Partículas
for _ in range(num_particulas):
    theta = np.random.uniform(-np.pi/2, np.pi/2)
    y1 = D * np.tan(theta) - d / 2
    y2 = D * np.tan(theta) + d / 2
    
    idx1 = int((y1 + 1) * (num_posiciones - 1) / 2)
    idx2 = int((y2 + 1) * (num_posiciones - 1) / 2)

    if 0 <= idx1 < num_posiciones:
        intensidad_particulas[idx1] += 1
    if 0 <= idx2 < num_posiciones:
        intensidad_particulas[idx2] += 1

intensidad_particulas /= np.max(intensidad_particulas)

### 2. Simulación del Experimento Doble Rendija Cuántico
for i in range(num_posiciones):
    position_on_screen = x[i]
    
    r1 = np.sqrt(D**2 + (position_on_screen + d/2)**2)
    r2 = np.sqrt(D**2 + (position_on_screen - d/2)**2)
    
    phi1 = (2 * np.pi / wavelength) * r1
    phi2 = (2 * np.pi / wavelength) * r2
    
    A1 = np.cos(phi1)
    A2 = np.cos(phi2)
    
    A_resultante = A1 + A2
    intensidad_cuantica[i] = A_resultante**2

intensidad_cuantica /= np.max(intensidad_cuantica)

### 3. Simulación del Experimento Doble Rendija con Ondas (Método Huygens-Fresnel)
for i in range(num_posiciones):
    position_on_screen = x[i]
    
    r1 = np.sqrt(D**2 + (position_on_screen + d/2)**2)  
    r2 = np.sqrt(D**2 + (position_on_screen - d/2)**2)  
    
    amplitude_1 = (np.sin(2 * np.pi * r1 / wavelength)) / r1   
    amplitude_2 = (np.sin(2 * np.pi * r2 / wavelength)) / r2   
    
    A_resultante_huygens = amplitude_1 + amplitude_2
    
    intensidad_ondas[i] = A_resultante_huygens**2

intensidad_ondas /= np.max(intensidad_ondas)

plt.figure(figsize=(15, 10))

plt.subplot(3, 1, 1)
plt.bar(x, intensidad_particulas, width=0.02, color='blue', alpha=0.7)
plt.title('Intensidad de Luz en el Objetivo - Experimento Doble Rendija (Partículas)')
plt.xlabel('Posición en el objetivo')
plt.ylabel('Intensidad Normalizada')
plt.ylim(0, 1.05)
plt.grid()

plt.subplot(3, 1, 2)
plt.bar(x, intensidad_cuantica, width=0.02, color='red', alpha=0.7)
plt.title('Intensidad Cuántica de Luz en el Objetivo - Experimento Doble Rendija')
plt.xlabel('Posición en el objetivo')
plt.ylabel('Intensidad Normalizada')
plt.ylim(0, 1.05)
plt.grid()

plt.subplot(3, 1, 3)
plt.bar(x, intensidad_ondas, width=0.02, color='green', alpha=0.7)
plt.title('Patrón de Interferencia - Experimento Doble Rendija con Ondas (Huygens-Fresnel)')
plt.xlabel('Posición en el objetivo')
plt.ylabel('Intensidad Normalizada')
plt.ylim(0, 1.05)
plt.grid()

plt.tight_layout()
plt.show()
